%p

- if user_signed_in?
  %p You are logged in
  //company collapsable
  - @companies.each_with_index do |company, index|
    .accordion{:id => "accordionCompany"}
      .card
        .card-header{:id => "headingOne"}
          .arrange-vertically.right
            Status
          
            - if index == 0
              .label.great
                .circle.validated.tooltip
                  .tooltiptext
                    Validated Data
            - elsif index == 1
              .label.ok
                .circle.validated.tooltip
                  .tooltiptext
                    Validated Data
            - else
              .label.bad
                .circle.unvalidated.tooltip
                  .tooltiptext
                    Invalidated or Missing Info
          %h5.mb-0
            .arrange-horizontally
              %button.btn.btn-link.overflow{"type" => "button", "data-toggle" => "collapse", "data-target" => "#collapse#{index}", "aria-hidden" => "true", "aria-controls" => "collapseOne"}
                #{company.name}
              
                        
          //categories collapsable
          .collapse{:id => "collapse#{index}", "aria-labelledby" => "headingOne", "data-parent" => "#accordionCompany"}
            - @categories.each_with_index do |category, index|
              .accordion{:id => "accordionCategory"}
                .card
                  .card-header{:id => "headingOne"}
                    .arrange-vertically.right
                      Status
                        
                      - if index == 0
                        .label.great
                          .circle.validated.tooltip
                            .tooltiptext
                              Validated Data
                      - elsif index == 1
                        .label.ok
                          .circle.validated.tooltip
                            .tooltiptext
                              Validated Data
                      - else
                        .label.bad
                          .circle.unvalidated.tooltip
                            .tooltiptext
                              Invalidated or Missing Info
                    %h5.mb-0
                      .arrange-horizontally
                        %button.btn.btn-link{"type" => "button", "data-toggle" => "collapse", "data-target" => "#collapseCat#{index}", "aria-hidden" => "true", "aria-controls" => "collapseOne"}
                          #{category.description}
                          
                                  
                      //subcat collapsables
                    .collapse{:id => "collapseCat#{index}", "aria-labelledby" => "headingOne", "data-parent" => "#accordionCategory"}
                      - category.subcategories.order('id ASC').each_with_index do |subcategory, index|
                        .accordion{:id => "accordionSubCat"}
                          .card
                            .card-header{:id => "headingOne"}
                              .arrange-vertically.right
                                Status
                              
                                - if index == 0
                                  .label.great
                                    .circle.validated.tooltip
                                      .tooltiptext
                                        Validated Data
                                - elsif index == 1
                                  .label.ok
                                    .circle.validated.tooltip
                                      .tooltiptext
                                        Validated Data
                                - else
                                  .label.bad
                                    .circle.unvalidated.tooltip
                                      .tooltiptext
                                        Invalidated or Missing Info
                              %h5.mb-0
                                .arrange-horizontally
                                  %button.btn.btn-link{"type" => "button", "data-toggle" => "collapse", "data-target" => "#collapseSubCat#{index}", "aria-hidden" => "true", "aria-controls" => "collapseOne"}
                                    #{subcategory.description}
                                    
                                            
                              //question collapsables
                              .collapse{:id => "collapseSubCat#{index}", "aria-labelledby" => "headingOne", "data-parent" => "#accordionSubCat"}
                                .card
                                  .card-body
                                    %table#questions
                                      %thead
                                        %tr
                                          %th{:class => @keyword_header}= link_to 'Question Keyword', questions_path(:sort => 'keyword'), :id => 'keyword_header'
                                          %th Answer Score
                                          %th{:class => @weight_header}= link_to 'Weight', questions_path(:sort => 'weight'), :id => 'weight_header'
                                      %tdescription
                                        - subcategory.questions.order('id ASC').each do |question|
                                          %tr
                                            %td= question.keyword
                                            %td= question.answer
                                            %td= question.weight
- else
  %P You are not logged in
%h1 Output